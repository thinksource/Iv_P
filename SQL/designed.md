# 关系型数据库设计核心原理

    ## 数据建模基础

        实体关系模型（ERD）与关系模型转换

        键的类型与作用（主键、外键、候选键）

        属性数据类型选择对存储/性能的影响（如INT vs VARCHAR）

    范式化设计（Normalization）

        1NF至3NF的核心规则与场景应用

        BCNF与4NF的适用场景

        范式化的代价：JOIN操作增加 vs 数据冗余减少

    反范式化设计（Denormalization）

        何时使用：高频查询优化、数据仓库场景

        常用技术：冗余字段、预计算字段、汇总表

        性能权衡：写入延迟 vs 读取加速

    关系完整性保障

        实体完整性（主键约束）

        参照完整性（外键约束的级联操作与性能损耗）

        业务规则约束（CHECK约束 vs 应用层校验）

二、高性能数据库设计策略

    索引设计与优化

        B+树索引原理与适用场景

        索引的代价：写操作延迟、存储空间占用

        复合索引设计（最左前缀原则）

        覆盖索引（Covering Index）避免回表

        何时避免索引：低基数字段、小表全扫描

    分区与分片策略

        水平分区（Range/List/Hash分区）

        垂直分区（列拆分减少I/O）

        分库分表（Sharding）路由策略

        分区陷阱：热点分区、跨分区查询性能

    高效Schema设计技巧

        避免过度使用NULL（索引失效风险）

        TEXT/BLOB分离存储策略

        枚举类型 vs 关联表查询性能对比

        时间序列数据特殊处理（分区表、BRIN索引）

三、大型复杂系统性能优化实战

    查询优化深度策略

        执行计划解读（EXPLAIN ANALYZE）

        避免全表扫描的索引优化

        N+1查询问题及解决方案（批量获取/JOIN优化）

        子查询优化 -> 改写为JOIN

    事务与并发控制

        ACID特性实现原理

        事务隔离级别对性能的影响（如MVCC开销）

        死锁检测与避免策略

        乐观锁 vs 悲观锁应用场景

    高并发处理方案

        读写分离架构（主从复制延迟问题）

        连接池配置优化（避免连接风暴）

        缓存策略（Redis缓存击穿/穿透应对）

        批量操作优化（批量插入 vs 单条提交）

    分布式数据库挑战

        CAP理论应用场景取舍

        分布式事务（2PC/TCC/Saga模式）

        全局ID生成方案（Snowflake/UUID）

四、大型数据库运维与调优

    性能监控工具链

        慢查询日志分析（pt-query-digest）

        实时监控：Prometheus + Grafana

        数据库健康检查（空间/锁/连接数）

    存储引擎特性对比

        InnoDB（聚簇索引、行锁） vs MyISAM（表锁）

        日志类引擎选择（TokuDB/ClickHouse）

    备份恢复与容灾

        在线热备份方案（XtraBackup）

        主从切换与故障转移

        异地多活架构设计要点

    硬件与配置优化

        磁盘类型选择（SSD vs HDD RAID配置）

        内存分配策略（Buffer Pool配置）

        文件系统优化（ext4/xfs/noatime）

五、典型场景解决方案

    高写入场景优化

        写缓冲区配置

        异步提交与批量合并

        分库分表写入路由

    混合负载管理

        OLTP与OLAP分离架构

        资源隔离（CPU/内存配额）

    海量数据存储方案

        冷热数据分离（OSS归档）

        数据生命周期管理（TTL自动清理）

    数据迁移实战

        全量+增量迁移方案

        双写一致性保障

        灰度切换验证流程

六、必备工具与技能

    SQL高级特性

        窗口函数性能优化

        CTE递归查询应用

        JSON/XML数据类型操作

    诊断工具

        perf 性能分析

        pt-kill 防雪崩

        sysbench 压测工具

    设计验证方法

        负载模拟测试（JMeter/Locust）

        容量规划模型（TPS/存储增长预测）